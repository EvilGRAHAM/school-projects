,Q4 == 6 ~ "Don't Remember"
))
,Q10 = factor(Q10, ordered = TRUE, levels = 5:1)
,`Q10 Response` = as.factor(case_when(
Q10 == 1 ~ "Excellent"
,Q10 == 2 ~ "Very Good"
,Q10 == 3 ~ "Good"
,Q10 == 4 ~ "Fair"
,Q10 == 5 ~ "Poor"
))
)
survey_data_q05$`Q10 Response` <-
factor(
x = survey_data_q05$`Q10 Response`
,ordered = TRUE
,levels = levels(survey_data_q05$`Q10 Response`)[c(4,2,3,5,1)]
)
survey_data_q05 %>%
ggplot(
aes(
x = `Q10 Response`
,colour = `Dr.`
,fill = `Dr.`
)
) +
geom_bar() +
facet_wrap(
~ `Dr.`
,scales = "free_y"
) +
scale_colour_brewer(
type = "qual"
,palette = "Set2"
) +
scale_fill_brewer(
type = "qual"
,palette = "Set2"
) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
survey_data_q05 %>%
ggplot(
aes(
x = `Q10 Response`
,colour = `Dr.`
,fill = `Dr.`
)
) +
geom_bar() +
# facet_wrap(
#   ~ `Dr.`
#   ,scales = "free_y"
# ) +
scale_colour_brewer(
type = "qual"
,palette = "Set2"
) +
scale_fill_brewer(
type = "qual"
,palette = "Set2"
) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
View(survey_data_q05)
survey_data_q05 <-
survey_data %>%
filter(
Q4 %in% 0:6
,Q10 < 8
) %>%
mutate(
Q4 = as.factor(Q4)
,`Dr.` = as.factor(case_when(
Q4 == 0 ~ "N/A"
,Q4 == 1 ~ "Alberts"
,Q4 == 2 ~ "Casey"
,Q4 == 3 ~ "Jones"
,Q4 == 4 ~ "Sayah"
,Q4 == 5 ~ "Wesson"
,Q4 == 6 ~ "Don't Remember"
))
,Q10 = factor(Q10, ordered = TRUE, levels = 5:1)
,`Q10 Response` = as.factor(case_when(
Q10 == 1 ~ "Excellent"
,Q10 == 2 ~ "Very Good"
,Q10 == 3 ~ "Good"
,Q10 == 4 ~ "Fair"
,Q10 == 5 ~ "Poor"
))
)
survey_data_q05$`Q10 Response` <-
factor(
x = survey_data_q05$`Q10 Response`
,ordered = TRUE
,levels = levels(survey_data_q05$`Q10 Response`)[c(4,2,3,5,1)]
)
survey_data_q05 %>%
ggplot(
aes(
x = `Q10 Response`
,colour = `Dr.`
,fill = `Dr.`
)
) +
geom_bar() +
facet_wrap(
~ `Dr.`
,scales = "free_y"
) +
scale_colour_brewer(
type = "qual"
,palette = "Set2"
) +
scale_fill_brewer(
type = "qual"
,palette = "Set2"
) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
survey_data_q05 %>%
ggplot(
aes(
x = `Q10 Response`
,colour = `Dr.`
,fill = `Dr.`
)
) +
geom_bar() +
facet_wrap(
~ `Dr.`
,scales = "free_y"
) +
scale_colour_brewer(
type = "qual"
,palette = "Set2"
) +
scale_fill_brewer(
type = "qual"
,palette = "Set2"
) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
survey_data_q05 %>%
group_by(`Dr.`) %>%
summarize(
`Average Rating` = mean(as.integer(Q10))
,`SD of Rating` = sd(as.integer(Q10))
) %>%
kable(digits = 4)
survey_data_q05 <-
survey_data %>%
filter(
Q4 %in% 0:6
,Q10 < 8
) %>%
mutate(
Q4 = as.factor(Q4)
,`Dr.` = as.factor(case_when(
Q4 == 0 ~ "N/A"
,Q4 == 1 ~ "Alberts"
,Q4 == 2 ~ "Casey"
,Q4 == 3 ~ "Jones"
,Q4 == 4 ~ "Sayah"
,Q4 == 5 ~ "Wesson"
,Q4 == 6 ~ "Don't Remember"
))
,Q10 = factor(Q10, ordered = TRUE, levels = 5:1)
,`Q10 Response` = as.factor(case_when(
Q10 == 1 ~ "Excellent"
,Q10 == 2 ~ "Very Good"
,Q10 == 3 ~ "Good"
,Q10 == 4 ~ "Fair"
,Q10 == 5 ~ "Poor"
))
)
survey_data_q05$`Dr.`
survey_data_q05$`Dr.` <-
factor(
x = survey_data_q05$`Dr.`
,ordered = TRUE
,levels = levels(survey_data_q05$`Dr.`)[c(3,1,2,4,5,6,7)]
)
survey_data_q05
survey_data_q05$`Dr.`
levels(survey_data_q05$`Dr.`)
survey_data_q05$`Dr.` <-
factor(
x = survey_data_q05$`Dr.`
,ordered = TRUE
,levels = levels(survey_data_q05$`Dr.`)[c(1,2,4,5,6,7,3)]
)
survey_data_q05$`Q10 Response` <-
factor(
x = survey_data_q05$`Q10 Response`
,ordered = TRUE
,levels = levels(survey_data_q05$`Q10 Response`)[c(4,2,3,5,1)]
)
levels(survey_data_q05$`Dr.`)
survey_data_q05$`Dr.` <-
factor(
x = survey_data_q05$`Dr.`
,ordered = TRUE
,levels = levels(survey_data_q05$`Dr.`)[c(1,2,4,5,6,7,3)]
)
survey_data_q05$`Q10 Response` <-
factor(
x = survey_data_q05$`Q10 Response`
,ordered = TRUE
,levels = levels(survey_data_q05$`Q10 Response`)[c(4,2,3,5,1)]
)
survey_data_q05 %>%
ggplot(
aes(
x = `Q10 Response`
,colour = `Dr.`
,fill = `Dr.`
)
) +
geom_bar() +
facet_wrap(
~ `Dr.`
,scales = "free_y"
) +
scale_colour_brewer(
type = "qual"
,palette = "Set2"
) +
scale_fill_brewer(
type = "qual"
,palette = "Set2"
) +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
q05_cumlogit <-
polr(
`Q10 Response` ~ `Dr.`
,data = survey_data_q05
)
summary(q05_cumlogit)
survey_data_q05$`Dr.
``
``
survey_data_q05$`Dr.`
survey_data_q05 <-
survey_data %>%
filter(
Q4 %in% 0:6
,Q10 < 8
) %>%
mutate(
Q4 = as.factor(Q4)
,`Dr.` = as.factor(case_when(
Q4 == 0 ~ "N/A"
,Q4 == 1 ~ "Alberts"
,Q4 == 2 ~ "Casey"
,Q4 == 3 ~ "Jones"
,Q4 == 4 ~ "Sayah"
,Q4 == 5 ~ "Wesson"
,Q4 == 6 ~ "Don't Remember"
))
,Q10 = factor(Q10, ordered = TRUE, levels = 5:1)
,`Q10 Response` = as.factor(case_when(
Q10 == 1 ~ "Excellent"
,Q10 == 2 ~ "Very Good"
,Q10 == 3 ~ "Good"
,Q10 == 4 ~ "Fair"
,Q10 == 5 ~ "Poor"
))
)
survey_data_q05$`Dr.` <-
factor(
x = survey_data_q05$`Dr.`
,ordered = TRUE
,levels = levels(survey_data_q05$`Dr.`)[c(1,2,4,5,6,7,3)]
)
levels(survey_data_q05$Dr.)
survey_data_q05$Dr.
survey_data_q05$`Dr.` <-
factor(
x = survey_data_q05$`Dr.`
,ordered = TRUE
,levels = levels(survey_data_q05$`Dr.`)[c(5, 3, 1, 2, 4, 6, 7)]
)
survey_data_q05
survey_data_q05 <-
survey_data %>%
filter(
Q4 %in% 0:6
,Q10 < 8
) %>%
mutate(
Q4 = as.factor(Q4)
,`Dr.` = as.factor(case_when(
Q4 == 0 ~ "N/A"
,Q4 == 1 ~ "Alberts"
,Q4 == 2 ~ "Casey"
,Q4 == 3 ~ "Jones"
,Q4 == 4 ~ "Sayah"
,Q4 == 5 ~ "Wesson"
,Q4 == 6 ~ "Don't Remember"
))
,Q10 = factor(Q10, ordered = TRUE, levels = 5:1)
,`Q10 Response` = as.factor(case_when(
Q10 == 1 ~ "Excellent"
,Q10 == 2 ~ "Very Good"
,Q10 == 3 ~ "Good"
,Q10 == 4 ~ "Fair"
,Q10 == 5 ~ "Poor"
))
)
survey_data_q05$`Dr.` <-
factor(
x = survey_data_q05$`Dr.`
,ordered = TRUE
,levels = levels(survey_data_q05$`Dr.`)[c(5, 3, 1, 2, 4, 6, 7)]
)
survey_data_q05$`Dr.`
q05_cumlogit
summary(q05_cumlogit)
predict(q05_cumlogit, newdata = data.frame(Dr. = Alberts))
predict(q05_cumlogit, newdata = data.frame(Dr. = "Alberts"))
predict(q05_cumlogit, newdata = data.frame(Dr. = "Alberts"), type = "probs")
predict(q05_cumlogit, newdata = data.frame(Dr. = c("Don't Remember", "Alberts"), type = "probs")
predict(q05_cumlogit, newdata = data.frame(Dr. = c("Don't Remember", "Alberts")), type = "probs")
levels(survey_data_q05$Dr.)
predict(q05_cumlogit, newdata = data.frame(Dr. = levels(survey_data_q05$Dr.)), type = "probs")
summary(q05_cumlogit)
knitr::opts_chunk$set(echo = FALSE)
library(MASS, warn.conflicts = FALSE, quietly = TRUE)
library(tidyverse, warn.conflicts = FALSE, quietly = TRUE)
library(magrittr, warn.conflicts = FALSE, quietly = TRUE)
library(knitr, warn.conflicts = FALSE, quietly = TRUE)
theme_minimal2 <- theme_minimal() %>%  theme_set()
theme_minimal2 <-
theme_update(
panel.border = element_rect(
linetype = "solid"
,colour = "grey92"
,fill = NA
)
,strip.background = element_rect(
linetype = "solid"
,colour = "grey92"
,fill = NA
)
)
scoreci <- function(x,n,conflev){
zalpha <- abs(qnorm((1-conflev)/2))
phat <- x/n
bound <- (zalpha*((phat*(1-phat)+(zalpha**2)/(4*n))/n)**(1/2))/
(1+(zalpha**2)/n)
midpnt <- (phat+(zalpha**2)/(2*n))/(1+(zalpha**2)/n)
uplim <- round(midpnt + bound,digits=4)
lowlim <- round(midpnt - bound,digits=4)
results <- data.frame(lowlim,uplim)
results
# This function computes a confidence interval for a proportion.
# It is based on inverting the large-sample normal score test for the
# proportion.  The input parameters are the number of successes, x, the
# total sample size, n, and the confidence level, conflev (e.g. 0.90).
# Returned are the endpoints for the 100*conflev % confidence
# interval for the proportion.
# binconf(x,n,conflev)
}
survey_data <-
"Project 01 Survey Data.txt" %>%
read_tsv(col_names = FALSE) %>%
select(-X13)
colnames(survey_data) <- c("Patient Number", paste0("Q", 1:10), "Waiting Time")
survey_data_q05 <-
survey_data %>%
filter(
Q4 %in% 0:6
,Q10 < 8
) %>%
mutate(
Q4 = as.factor(Q4)
,`Dr.` = as.factor(case_when(
Q4 == 0 ~ "N/A"
,Q4 == 1 ~ "Alberts"
,Q4 == 2 ~ "Casey"
,Q4 == 3 ~ "Jones"
,Q4 == 4 ~ "Sayah"
,Q4 == 5 ~ "Wesson"
,Q4 == 6 ~ "Don't Remember"
))
,Q10 = factor(Q10, ordered = TRUE, levels = 5:1)
,`Q10 Response` = as.factor(case_when(
Q10 == 1 ~ "Excellent"
,Q10 == 2 ~ "Very Good"
,Q10 == 3 ~ "Good"
,Q10 == 4 ~ "Fair"
,Q10 == 5 ~ "Poor"
))
)
survey_data_q05$`Dr.` <-
factor(
x = survey_data_q05$`Dr.`
,ordered = FALSE
,levels = levels(survey_data_q05$`Dr.`)[c(5, 3, 1, 2, 4, 6, 7)]
)
survey_data_q05$`Q10 Response` <-
factor(
x = survey_data_q05$`Q10 Response`
,ordered = TRUE
,levels = levels(survey_data_q05$`Q10 Response`)[c(4, 2, 3, 5, 1)]
)
survey_data_q05 %>%
ggplot(
aes(
x = `Q10 Response`
,colour = `Dr.`
,fill = `Dr.`
)
) +
geom_bar() +
facet_wrap(
~ `Dr.`
,scales = "free_y"
) +
scale_colour_brewer(
type = "qual"
,palette = "Set2"
) +
scale_fill_brewer(
type = "qual"
,palette = "Set2"
) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(
title = "Figure 02: Considering all aspects of your most recent visit, \nhow would you rate the services you received?"
,x = "Rating for Each Doctor"
)
survey_data_q05 %>%
group_by(`Dr.`) %>%
summarize(
`Average Rating` = mean(as.integer(Q10))
,`SD of Rating` = sd(as.integer(Q10))
) %>%
kable(digits = 4, caption = "Average and Standard Deviation of Rating (Higher is Better)")
survey_data_q05_scores <-
survey_data_q05 %>%
group_by(`Dr.`, `Q10 Response`) %>%
summarize(
`Number of Patients` = length(`Dr.`)
) %>%
spread(
key = `Q10 Response`
,value = `Number of Patients`
) %>%
mutate(
Positive = sum(Excellent, `Very Good`, Good/2)
,Negative =  sum(Good/2, Fair, Poor)
,`Number of Patients` = sum(Positive, Negative)
) %>%
mutate(
Score = scoreci(x = Positive, n = `Number of Patients`, conflev = 0.95)$lowlim
)
survey_data_q05_scores %>%
kable(digits = 4, caption = "Lower Bound of Wilson Score Confidence Interval")
survey_data_q05_scores
survey_data_q05_scores["Jones"]
survey_data_q05_scores %>% filter(Dr. == "Jones") %>% select(Score) %>% as.numeric()
survey_data_q05_scores %>% ungroup() %>% filter(Dr. == "Jones") %>% select(Score) %>% as.numeric()
survey_data_q05_scores %>% ungroup() %>% filter(Dr. == "Jones") %>% select("Number of Patients"") %>% as.numeric()
survey_data_q05_scores %>% ungroup() %>% filter(Dr. == "Jones") %>% select("Number of Patients") %>% as.numeric()
survey_data_q05_scores %>% ungroup() %>% filter(Dr. == "Jones") %>% select("Number of Patients") %>% as.numeric()
View(survey_data_q05)
q05_cumlogit <-
polr(
`Q10 Response` ~ `Dr.`
,data = survey_data_q05
)
q05_cumlogit <-
polr(
`Q10 Response` ~ `Dr.`
,data = survey_data_q05
)
summary(q05_cumlogit)
q05_cumlogit$zeta
q05_cumlogit$lev
q05_cumlogit$edf
q05_cumlogit$terms
q05_cumlogit$lp
q05_cumlogit$contrasts
q05_cumlogit$xlevels
names(summary(q05_cumlogit))
q05_cumlogit$coefficients
names(summary(q05_cumlogit))
summary(q05_cumlogit)$digits
summary(q05_cumlogit)$pc
summary(q05_cumlogit)$xlevels
summary(q05_cumlogit)$contrasts
summary(q05_cumlogit)$t.value
summary(q05_cumlogit)$Std.Error
summary(q05_cumlogit)$deviance
pt(0.8348)
pt(0.8348, 1)
pt(0.8348, 1, lower.tail = FALSE
)
pt(0.8348, 1, lower.tail = FALSE)
anova(  polr(
`Q10 Response` ~ `Dr.`
,data = survey_data_q05
),  polr(
`Q10 Response` ~ 1
,data = survey_data_q05
))
q05_cumlogit_int <-
polr(
`Q10 Response` ~ 1
,data = survey_data_q05
)
anova(q05_cumlogit, q05_cumlogit_int)
anova(q05_cumlogit, q05_cumlogit_int) %>% kable()
anova(q05_cumlogit, q05_cumlogit_int) %>%
kable()
