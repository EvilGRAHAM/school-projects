polr(
`Q10 Response` ~ 1
,data = survey_data_q05
)
anova(q05_cumlogit, q05_cumlogit_int)
anova(q05_cumlogit, q05_cumlogit_int) %>% kable()
anova(q05_cumlogit, q05_cumlogit_int) %>%
kable()
knitr::opts_chunk$set(echo = FALSE)
library(MASS, warn.conflicts = FALSE, quietly = TRUE)
library(tidyverse, warn.conflicts = FALSE, quietly = TRUE)
library(magrittr, warn.conflicts = FALSE, quietly = TRUE)
library(knitr, warn.conflicts = FALSE, quietly = TRUE)
theme_minimal2 <- theme_minimal() %>%  theme_set()
theme_minimal2 <-
theme_update(
panel.border = element_rect(
linetype = "solid"
,colour = "grey92"
,fill = NA
)
,strip.background = element_rect(
linetype = "solid"
,colour = "grey92"
,fill = NA
)
)
scoreci <- function(x,n,conflev){
zalpha <- abs(qnorm((1-conflev)/2))
phat <- x/n
bound <- (zalpha*((phat*(1-phat)+(zalpha**2)/(4*n))/n)**(1/2))/
(1+(zalpha**2)/n)
midpnt <- (phat+(zalpha**2)/(2*n))/(1+(zalpha**2)/n)
uplim <- round(midpnt + bound,digits=4)
lowlim <- round(midpnt - bound,digits=4)
results <- data.frame(lowlim,uplim)
results
# This function computes a confidence interval for a proportion.
# It is based on inverting the large-sample normal score test for the
# proportion.  The input parameters are the number of successes, x, the
# total sample size, n, and the confidence level, conflev (e.g. 0.90).
# Returned are the endpoints for the 100*conflev % confidence
# interval for the proportion.
# binconf(x,n,conflev)
}
survey_data <-
"Project 01 Survey Data.txt" %>%
read_tsv(col_names = FALSE) %>%
select(-X13)
colnames(survey_data) <- c("Patient Number", paste0("Q", 1:10), "Waiting Time")
View(survey_data)
survey_data %>%
filter(
Q2 != 1
,`Waiting Time` > 0
) %>%
kable(caption = "Patients Who Indicated They Didn't Wait, but Listed a Waiting Time")
survey_data %>%
filter(
Q2 == c(1,2,3)
,`Waiting Time` > 0
) %>%
kable(caption = "Patients Who Indicated They Didn't Wait, but Listed a Waiting Time")
survey_data %>%
filter(
Q2 == c(1, 3, 4)
,`Waiting Time` > 0
) %>%
kable(caption = "Patients Who Indicated They Didn't Wait, but Listed a Waiting Time")
survey_data %>%
filter(
Q2 == 1 | Q2 == 3 | Q2 == 4
,`Waiting Time` > 0
) %>%
kable(caption = "Patients Who Indicated They Didn't Wait, but Listed a Waiting Time")
survey_data %>%
filter(
(Q2 == 1 & `Waiting Time` > 0)
| (Q2 != 1 & `Waiting Time` == 0)
) %>%
kable(caption = "Patients Who Indicated They Didn't Wait, but Listed a Waiting Time")
survey_data %>%
filter(
(Q2 == 1 & `Waiting Time` > 0)
| (Q2 == 2 & `Waiting Time` == 0)
) %>%
kable(caption = "Patients Who Indicated They Didn't Wait, but Listed a Waiting Time")
# |(Q4 != 1 |Q5 != 0 |Q6 != 0 |Q7 != 0)
# |(Q4 != 0 |Q5 != 1 |Q6 != 0 |Q7 != 0)
# |(Q4 != 0 |Q5 != 0 |Q6 != 0 |Q7 != 0)
# |(Q4 != 0 |Q5 != 0 |Q6 != 0 |Q7 != 0)
) %>%
survey_data %>%
filter(
Q3 != 1
,(Q4 != 0 |Q5 != 0 |Q6 != 0 |Q7 != 0)
|(Q4 == 0 |Q5 != 0 |Q6 != 0 |Q7 != 0)
|(Q4 != 0 |Q5 != 0 |Q6 != 0 |Q7 != 0)
|(Q4 != 0 |Q5 != 0 |Q6 != 0 |Q7 != 0)
|(Q4 != 0 |Q5 != 0 |Q6 != 0 |Q7 == 0)
) %>%
kable(caption = "Patients with Errors in Questions 04-07")
survey_data %>%
filter(
(Q3 != 1 & (Q4 != 0 |Q5 != 0 |Q6 != 0 |Q7 != 0))
|(Q3 == 1 & (Q7 == 0))
) %>%
kable(caption = "Patients with Errors in Questions 04-07")
survey_data %>%
filter(
(Q3 != 1 & (Q4 != 0 |Q5 != 0 |Q6 != 0 |Q7 != 0))
|(Q3 == 1 & (Q4 == 0) | (Q5 == 0) | (Q6 == 0) | (Q7 == 0))
) %>%
kable(caption = "Patients with Errors in Questions 04-07")
# |(Q3 == 1 & (Q4 == 0) | (Q5 == 0) | (Q6 == 0) | (Q7 == 0))
) %>%
survey_data %>%
filter(
(Q3 != 1 & (Q4 != 0 |Q5 != 0 |Q6 != 0 |Q7 != 0))
# |(Q3 == 1 & (Q4 == 0) | (Q5 == 0) | (Q6 == 0) | (Q7 == 0))
) %>%
kable(caption = "Patients with Errors in Questions 04-07")
survey_data %>%
filter(
(Q3 != 1 & (Q4 != 0 |Q5 != 0 |Q6 != 0 |Q7 != 0))
|(Q3 == 1 & (Q4 == 0)) #| (Q5 == 0) | (Q6 == 0) | (Q7 == 0))
) %>%
kable(caption = "Patients with Errors in Questions 04-07")
survey_data %>%
filter(
(Q3 != 1 & (Q4 != 0 |Q5 != 0 |Q6 != 0 |Q7 != 0))
|(Q3 == 1 & (Q4 == 0) | (Q5 == 0))# | (Q6 == 0) | (Q7 == 0))
) %>%
kable(caption = "Patients with Errors in Questions 04-07")
survey_data %>%
filter(
(Q3 != 1 & (Q4 != 0 |Q5 != 0 |Q6 != 0 |Q7 != 0))
|(Q3 == 1 & (Q4 == 0 | Q5 == 0 | Q6 == 0 | Q7 == 0))
) %>%
kable(caption = "Patients with Errors in Questions 04-07")
survey_data %>%
filter(Q2 != 1)
survey_data %>%
filter(Q2 != 1) %>%
select(`Waiting Time`) %>%
summary() %>%
kable(caption = "Summary Statistics for Waiting Time")
survey_data %>%
filter(Q2 == 2) %>%
select(`Waiting Time`) %>%
summary() %>%
kable(caption = "Summary Statistics for Waiting Time")
survey_data %>%
filter(Q2 == 2) %>%
select(`Waiting Time`) %>%
summary() %>%
kable(caption = "Summary Statistics for Waiting Time for those who didn't Meet a Nurse Promptly")
survey_data %>%
filter(Q2 == 2) %>%
ggplot(aes(x = `Waiting Time`)) +
geom_density() +
labs(
title = "Figure 01: Kernel Density Estimator for Waiting Time"
,x = "Waiting Time (min)"
)
tools::toTitleCase(  filter(Q2 == 2) %>%
)
tools::toTitleCase("Summary Statistics for Waiting Time for those who didn't Meet a Nurse Promptly")
install.packages("ggridges")
library(ggridges)
survey_data_q05 %>%
ggplot(
aes(
x = `Q10 Response`
,colour = `Dr.`
,fill = `Dr.`
)
) +
geom_bar() +
facet_wrap(
~ `Dr.`
,scales = "free_y"
) +
scale_colour_brewer(
type = "qual"
,palette = "Set2"
) +
scale_fill_brewer(
type = "qual"
,palette = "Set2"
) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(
title = "Figure 02: Considering all aspects of your most recent visit, \nhow would you rate the services you received?"
,x = "Rating for Each Doctor"
)
survey_data_q05 <-
survey_data %>%
filter(
Q4 %in% 0:6
,Q10 < 8
) %>%
mutate(
Q4 = as.factor(Q4)
,`Dr.` = as.factor(case_when(
Q4 == 0 ~ "N/A"
,Q4 == 1 ~ "Alberts"
,Q4 == 2 ~ "Casey"
,Q4 == 3 ~ "Jones"
,Q4 == 4 ~ "Sayah"
,Q4 == 5 ~ "Wesson"
,Q4 == 6 ~ "Don't Remember"
))
,Q10 = factor(Q10, ordered = TRUE, levels = 5:1)
,`Q10 Response` = as.factor(case_when(
Q10 == 1 ~ "Excellent"
,Q10 == 2 ~ "Very Good"
,Q10 == 3 ~ "Good"
,Q10 == 4 ~ "Fair"
,Q10 == 5 ~ "Poor"
))
)
survey_data_q05$`Dr.` <-
factor(
x = survey_data_q05$`Dr.`
,ordered = FALSE
,levels = levels(survey_data_q05$`Dr.`)[c(5, 3, 1, 2, 4, 6, 7)]
)
survey_data_q05$`Dr.` <-
factor(
x = survey_data_q05$`Dr.`
,ordered = FALSE
,levels = levels(survey_data_q05$`Dr.`)[c(5, 3, 1, 2, 4, 6, 7)]
)
survey_data_q05$`Q10 Response` <-
factor(
x = survey_data_q05$`Q10 Response`
,ordered = TRUE
,levels = levels(survey_data_q05$`Q10 Response`)[c(4, 2, 3, 5, 1)]
)
survey_data_q05 %>%
ggplot(
aes(
x = `Q10 Response`
,colour = `Dr.`
,fill = `Dr.`
)
) +
geom_bar() +
facet_wrap(
~ `Dr.`
,scales = "free_y"
) +
scale_colour_brewer(
type = "qual"
,palette = "Set2"
) +
scale_fill_brewer(
type = "qual"
,palette = "Set2"
) +
theme(axis.text.x = element_text(angle = 45, hjust = 1)) +
labs(
title = "Figure 02: Considering all aspects of your most recent visit, \nhow would you rate the services you received?"
,x = "Rating for Each Doctor"
)
survey_data_q05 %>%
ggplot(
aes(
x = `Q10 Response`
,colour = `Dr.`
,fill = `Dr.`
)
) +
geom_density_ridges()
survey_data_q05 %>%
ggplot(
aes(
x = `Q10 Response`
,colour = `Dr.`
,fill = `Dr.`
)
) +
geom_ridges()
survey_data_q05 %>%
ggplot(
aes(
x = `Q10 Response`
,colour = `Dr.`
,fill = `Dr.`
)
) +
ggridges::geom_ridgeline()
survey_data_q05 %>%
ggplot(
aes(
x = `Q10 Response`
,y = ..count..
,colour = `Dr.`
,fill = `Dr.`
)
) +
ggridges::geom_ridgeline()
survey_data_q05 %>%
ggplot(
aes(
x = `Q10 Response`
,y = ..density..
,colour = `Dr.`
,fill = `Dr.`
)
) +
ggridges::geom_ridgeline()
survey_data_q05 %>%
tally()
survey_data_q05
survey_data_q05 %>%
group_by(`Dr.`)
survey_data_q05 %>%
group_by(`Dr.`) %>%
select(`Dr.`, `Q10 Response`) %>%
tally()
survey_data_q05 %>%
group_by(`Dr.`, `Q10 Response`) %>%
select(`Dr.`, `Q10 Response`) %>%
tally()
ggplot(
aes(
x = `Q10 Response`
,y = n
,colour = `Dr.`
,fill = `Dr.`
)
) +
ggridges::geom_ridgeline()
survey_data_q05 %>%
group_by(`Dr.`, `Q10 Response`) %>%
select(`Dr.`, `Q10 Response`) %>%
tally() %>%
ggplot(
aes(
x = `Q10 Response`
,y = n
,colour = `Dr.`
,fill = `Dr.`
)
) +
ggridges::geom_ridgeline()
survey_data_q05 %>%
group_by(`Dr.`, `Q10 Response`) %>%
select(`Dr.`, `Q10 Response`) %>%
tally()
survey_data_q05 %>%
group_by(`Dr.`, `Q10 Response`) %>%
select(`Dr.`, `Q10 Response`) %>%
tally() %>%
ggplot(
aes(
x = `Q10 Response`
,y = n
,colour = `Dr.`
,fill = `Dr.`
)
) +
ggridges::geom_ridgeline()
survey_data_q05 %>%
group_by(`Dr.`, `Q10 Response`) %>%
select(`Dr.`, `Q10 Response`) %>%
tally() %>%
ggplot(
aes(
x = `Q10 Response`
,y = n
,colour = `Dr.`
,fill = `Dr.`
)
) +
ggridges::geom_density_ridges2()
survey_data_q05 %>%
group_by(`Dr.`, `Q10 Response`) %>%
select(`Dr.`, `Q10 Response`) %>%
tally() %>%
ggplot(
aes(
x = `Q10 Response`
,y = n
# ,colour = `Dr.`
,fill = `Dr.`
)
) +
ggridges::geom_density_ridges2()
survey_data_q05 %>%
group_by(`Dr.`, `Q10 Response`) %>%
select(`Dr.`, `Q10 Response`) %>%
tally() %>%
ggplot(
aes(
x = `Q10 Response`
,y = n
# ,colour = `Dr.`
,fill = `Dr.`
)
) +
ggridges::geom_density_ridges2(stat = "identity")
survey_data_q05 %>%
group_by(`Dr.`, `Q10 Response`) %>%
select(`Dr.`, `Q10 Response`) %>%
tally() %>%
ggplot(
aes(
x = `Q10 Response`
,y = n
# ,colour = `Dr.`
,fill = `Dr.`
)
) +
ggridges::geom_density_ridges2(stat = "count")
survey_data_q05 %>%
group_by(`Dr.`, `Q10 Response`) %>%
select(`Dr.`, `Q10 Response`) %>%
tally() %>%
ggplot(
aes(
x = `Q10 Response`
# ,y = n
# ,colour = `Dr.`
,fill = `Dr.`
)
) +
ggridges::geom_density_ridges2(stat = "count")
survey_data_q05 %>%
group_by(`Dr.`, `Q10 Response`) %>%
select(`Dr.`, `Q10 Response`) %>%
tally() %>%
ggplot(
aes(
x = `Q10 Response`
# ,y = n
# ,colour = `Dr.`
,fill = `Dr.`
)
) +
ggridges::geom_ridgeline()
survey_data_q05 %>%
group_by(`Dr.`, `Q10 Response`) %>%
select(`Dr.`, `Q10 Response`) %>%
tally() %>%
ggplot(
aes(
x = `Q10 Response`
,y = n
,colour = `Dr.`
,fill = `Dr.`
)
) +
ggridges::geom_ridgeline()
survey_data_q05 %>%
group_by(`Dr.`, `Q10 Response`) %>%
select(`Dr.`, `Q10 Response`) %>%
tally() %>%
ggplot(
aes(
x = `Q10 Response`
,y = `Dr.`
,height = n
,colour = `Dr.`
,fill = `Dr.`
)
) +
ggridges::geom_ridgeline()
survey_data_q05 %>%
group_by(`Dr.`, `Q10 Response`) %>%
select(`Dr.`, `Q10 Response`) %>%
tally() %>%
ggplot(
aes(
x = `Q10 Response`
,y = `Dr.`
,height = n
,colour = `Dr.`
,fill = `Dr.`
)
) +
ggridges::geom_ridgeline(stat = "identity")
survey_data_q05 %>%
group_by(`Dr.`, `Q10 Response`) %>%
select(`Dr.`, `Q10 Response`) %>%
tally() %>%
ggplot(
aes(
x = `Q10 Response`
,y = `Dr.`
,height = n
,groupr.`
,fill = `Dr.`
)
) +
ggridges::geom_ridgeline(stat = "identity")
survey_data_q05 %>%
group_by(`Dr.`, `Q10 Response`) %>%
select(`Dr.`, `Q10 Response`) %>%
tally() %>%
ggplot(
aes(
x = `Q10 Response`
,y = `Dr.`
,height = n
,group = `Dr.`
,fill = `Dr.`
)
) +
ggridges::geom_ridgeline(stat = "identity")
